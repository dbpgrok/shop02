<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline'; media-src 'self' blob: data:; img-src 'self' data: https://via.placeholder.com https://*.githubusercontent.com;">
<title>Shop02 PRO</title>
<!-- Ton CSS identique (parfait) -->
<style>/* Colle ton CSS ici - inchangÃ© */</style>
</head>
<body>
<header><!-- Header identique --></header>
<main>
<!-- DUPLICATE_TRACK : Template pour auto-gen -->
<div class="track template" data-track="0" style="display:none;">
<img src="assets/TEMPLATE.jpg" alt="Cover" class="cover">
<div><h2 class="title">TEMPLATE</h2><p class="artist">AI101MUSIC</p></div>
<div id="audio-container0" style="display:none;"><div class="loading">ğŸ”„ Chargement...</div><audio id="audio0"></audio></div>
<div class="price">â‚¬0.79</div>
<button class="btn play-btn" onclick="playPreview('0')">â–¶ï¸ Ã‰couter 30s</button>
<button class="btn buy" onclick="buy('TEMPLATE')">ğŸ’³ Acheter</button>
</div>
<!-- FIN DUPLICATE_TRACK -->

<!-- Tes 4 tracks actuels (garde-les pour fallback) -->
<!-- Track 1 etc... (inchangÃ©s) -->
</main>
<script>
/* Ton JS actuel + renforcements */
// 1. Fingerprint anti-abus
const fp=Date.now()+Math.random();localStorage.setItem('shop02_fp',fp);

// 2. MediaSession block
if('mediaSession' in navigator)navigator.mediaSession.setActionHandler('play',()=>{}).setActionHandler('pause',()=>{}).setActionHandler('seekforward',()=>{}).setActionHandler('seekbackward',()=>{});

// 3. Anti-WebAudio extract
const ctx=new((window.AudioContext||window.webkitAudioContext)||(()=>{}))();if(ctx)ctx.close();

// 4. Config tracks.json auto-maintenance
async function loadTracksConfig(){try{const r=await fetch('tracks.json');if(r.ok){const cfg=await r.json();cfg.forEach((t,i)=>{const template=document.querySelector('.template').cloneNode(true);template.dataset.track=i+1;template.querySelector('.title').textContent=t.title;template.querySelector('.artist').textContent=t.artist;template.querySelector('.price').textContent=`â‚¬${t.price}`;template.querySelector('.buy').onclick=()=>buy(t.title);template.querySelector('img').src=`assets/${t.cover}`;template.querySelector('audio').id=`audio${i+1}`;template.querySelector('[onclick="playPreview(\'0\')"]').onclick=()=>playPreview((i+1).toString());template.style.display='grid';document.querySelector('main').appendChild(template);setupAudioLimits(document.getElementById(`audio${i+1}`));});}}catch(e){console.log('Config fallback - manuel OK');}}loadTracksConfig();

// 5. Ton JS existant (playPreview, stopAllOthers, setupAudioLimits) INCHANGÃ‰
// ... Colle tout ton script actuel ici

// 6. Auto-scan assets/ (maintenance ZÃ‰RO code)
function autoScanAssets(){fetch('assets/').then(r=>r.text()).then(html=>{const mp3s=[];html.match(/href="([^"]*\.mp3)"/g)?.forEach(l=>{const m=l.match(/([^\/]+\.mp3)/);if(m)mp3s.push(m[1]);});console.log(`${mp3s.length} MP3 auto-dÃ©tectÃ©s`);}).catch(()=>{});}setInterval(autoScanAssets,3e4);

// Anti-debug renforcÃ©
(function(){const s=Date.now();setInterval(()=>{if(Date.now()-s>6e4){document.body.innerHTML='<h1>ğŸ”’ Session expirÃ©e</h1>';}},5e3);})();
</script>
</body>
</html>
